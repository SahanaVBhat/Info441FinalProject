{"ast":null,"code":"import _regeneratorRuntime from \"/Users/chris-yee/Desktop/Info441FinalProject/clients/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/chris-yee/Desktop/Info441FinalProject/clients/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/Users/chris-yee/Desktop/Info441FinalProject/clients/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/chris-yee/Desktop/Info441FinalProject/clients/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/chris-yee/Desktop/Info441FinalProject/clients/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/chris-yee/Desktop/Info441FinalProject/clients/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/chris-yee/Desktop/Info441FinalProject/clients/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/chris-yee/Desktop/Info441FinalProject/clients/src/Components/Profile.js\";\nimport React, { Component } from 'react';\nimport Auth from './Auth/Auth';\nimport PageTypes from '../Constants/PageTypes/PageTypes';\nimport Main from './Main/Main';\nimport '../Styles/App.css';\nimport api from '../Constants/APIEndpoints/APIEndpoints';\n\nvar Profile =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Profile, _Component);\n\n  function Profile() {\n    var _this;\n\n    _classCallCheck(this, Profile);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Profile).call(this));\n    _this.getCurrentUser =\n    /*#__PURE__*/\n    _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee() {\n      var response, user;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              if (_this.state.authToken) {\n                _context.next = 2;\n                break;\n              }\n\n              return _context.abrupt(\"return\");\n\n            case 2:\n              _context.next = 4;\n              return fetch(api.base + api.handlers.myuser, {\n                headers: new Headers({\n                  \"Authorization\": _this.state.authToken\n                })\n              });\n\n            case 4:\n              response = _context.sent;\n\n              if (!(response.status >= 300)) {\n                _context.next = 11;\n                break;\n              }\n\n              alert(\"Unable to verify login. Logging out...\");\n              localStorage.setItem(\"Authorization\", \"\");\n\n              _this.setAuthToken(\"\");\n\n              _this.setUser(null);\n\n              return _context.abrupt(\"return\");\n\n            case 11:\n              _context.next = 13;\n              return response.json();\n\n            case 13:\n              user = _context.sent;\n\n              _this.setUser(user);\n\n            case 15:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, this);\n    }));\n\n    _this.setPageToSignIn = function (e) {\n      e.preventDefault();\n\n      _this.setState({\n        page: PageTypes.signIn\n      });\n    };\n\n    _this.setPageToSignUp = function (e) {\n      e.preventDefault();\n\n      _this.setState({\n        page: PageTypes.signUp\n      });\n    };\n\n    _this.setPage = function (e, page) {\n      e.preventDefault();\n\n      _this.setState({\n        page: page\n      });\n    };\n\n    _this.setAuthToken = function (authToken) {\n      _this.setState({\n        authToken: authToken,\n        page: authToken === \"\" ? PageTypes.signIn : PageTypes.signedInMain\n      });\n    };\n\n    _this.setUser = function (user) {\n      _this.setState({\n        user: user\n      });\n    };\n\n    _this.state = {\n      page: localStorage.getItem(\"Authorization\") ? PageTypes.signedInMain : PageTypes.signIn,\n      authToken: localStorage.getItem(\"Authorization\") || null,\n      user: null\n    };\n\n    _this.getCurrentUser();\n\n    return _this;\n  }\n  /**\n   * @description Gets the users\n   */\n\n\n  _createClass(Profile, [{\n    key: \"render\",\n    value: function render() {\n      var _this$state = this.state,\n          page = _this$state.page,\n          user = _this$state.user;\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 84\n        },\n        __self: this\n      }, user ? React.createElement(Main, {\n        page: page,\n        setPage: this.setPage,\n        setAuthToken: this.setAuthToken,\n        user: user,\n        setUser: this.setUser,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 86\n        },\n        __self: this\n      }) : React.createElement(Auth, {\n        page: page,\n        setPage: this.setPage,\n        setAuthToken: this.setAuthToken,\n        setUser: this.setUser,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 92\n        },\n        __self: this\n      }));\n    }\n  }]);\n\n  return Profile;\n}(Component);\n\nexport default Profile;","map":{"version":3,"sources":["/Users/chris-yee/Desktop/Info441FinalProject/clients/src/Components/Profile.js"],"names":["React","Component","Auth","PageTypes","Main","api","Profile","getCurrentUser","state","authToken","fetch","base","handlers","myuser","headers","Headers","response","status","alert","localStorage","setItem","setAuthToken","setUser","json","user","setPageToSignIn","e","preventDefault","setState","page","signIn","setPageToSignUp","signUp","setPage","signedInMain","getItem"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport Auth from './Auth/Auth';\nimport PageTypes from '../Constants/PageTypes/PageTypes';\nimport Main from './Main/Main';\nimport '../Styles/App.css';\nimport api from '../Constants/APIEndpoints/APIEndpoints';\n\n\nclass Profile extends Component {\n    constructor() {\n        super();\n        this.state = {\n            page: localStorage.getItem(\"Authorization\") ? PageTypes.signedInMain : PageTypes.signIn,\n            authToken: localStorage.getItem(\"Authorization\") || null,\n            user: null\n        }\n\n        this.getCurrentUser()\n    }\n\n\n    /**\n     * @description Gets the users\n     */\n    getCurrentUser = async () => {\n        if (!this.state.authToken) {\n            return;\n        }\n        const response = await fetch(api.base + api.handlers.myuser, {\n            headers: new Headers({\n                \"Authorization\": this.state.authToken\n            })\n        });\n        if (response.status >= 300) {\n            alert(\"Unable to verify login. Logging out...\");\n            localStorage.setItem(\"Authorization\", \"\");\n            this.setAuthToken(\"\");\n            this.setUser(null)\n            return;\n        }\n        const user = await response.json()\n        this.setUser(user);\n\n    }\n\n    /**\n     * @description sets the page type to sign in\n     */\n    setPageToSignIn = (e) => {\n        e.preventDefault();\n        this.setState({ page: PageTypes.signIn });\n    }\n\n    /**\n     * @description sets the page type to sign up\n     */\n    setPageToSignUp = (e) => {\n        e.preventDefault();\n        this.setState({ page: PageTypes.signUp });\n    }\n\n    setPage = (e, page) => {\n        e.preventDefault();\n        this.setState({ page });\n    }\n\n    /**\n     * @description sets auth token\n     */\n    setAuthToken = (authToken) => {\n        this.setState({ authToken, page: authToken === \"\" ? PageTypes.signIn : PageTypes.signedInMain });\n    }\n\n    /**\n     * @description sets the user\n     */\n    setUser = (user) => {\n        this.setState({ user });\n    }\n\n    render() {\n        const { page, user } = this.state;\n        return (\n            <div>\n                {user ?\n                    <Main page={page}\n                        setPage={this.setPage}\n                        setAuthToken={this.setAuthToken}\n                        user={user}\n                        setUser={this.setUser} />\n                    :\n                    <Auth page={page}\n                        setPage={this.setPage}\n                        setAuthToken={this.setAuthToken}\n                        setUser={this.setUser} />\n                }\n            </div>\n        );\n    }\n}\n\nexport default Profile;"]},"metadata":{},"sourceType":"module"}